<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siemens Energy Ikon</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* A korábbi stílusok változatlanok */
    </style>
</head>
<body onload="toggleFullscreen(); hideAllTabs();">
    <div class="container" id="container">
        <div class="header">
            <div class="header-left">
                <img src="siemens-energy-logo.png" alt="Siemens Energy Logo">
            </div>
            <div class="header-right">
                <span id="userEmail"></span>
                <i class="fas fa-envelope" title="Üzenetek" onclick="openTab('chat-lista')"></i>
                <i class="fas fa-user" title="Profiladatok" onclick="toggleProfile()"></i>
                <i class="fas fa-question-circle" title="Segítség" onclick="openTab('felhasználó-kezelés')"></i>
                <span>v1.0.2</span> <!-- Verziószám növelve -->
                <i class="fas fa-expand fullscreen-icon" onclick="toggleFullscreen()" title="Teljes képernyő"></i>
            </div>
        </div>
        <div class="divider"></div>
        <div class="tabs">
            <!-- A lapfülek változatlanok -->
        </div>
        <div id="logisztikai-adatbazis" class="tab-content">
            <!-- A táblázat változatlan -->
        </div>
        <!-- További tabok változatlanok -->
        <div id="profil" class="tab-content" style="display: none;">
            <h2>Saját profil</h2>
            <p>Email: <span id="profilEmail"></span></p>
            <p>Utolsó belépés: 2025.03.21</p>
            <button class="logout-btn" onclick="logout()">Kijelentkezés</button>
        </div>
    </div>

    <!-- Modal ablak a belépéshez -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="login-form">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
                <label for="password">Jelszó:</label>
                <input type="password" id="password" name="password" required>
                <button onclick="checkLogin()">Belépés</button>
                <div id="result"></div>
            </div>
        </div>
    </div>

    <!-- Modal ablakok új rekordhoz és szerkesztéshez -->
    <div class="modal" id="newRecordModal" style="display: none;">
        <div class="modal-content">
            <div class="new-record-form" id="newRecordForm">
                <h2>Új rekord</h2>
            </div>
        </div>
    </div>

    <script>
        function hideAllTabs() {
            const tabContents = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
        }

        const savedEmail = localStorage.getItem("email");
        if (savedEmail) {
            document.getElementById("email").value = savedEmail;
            document.getElementById("userEmail").textContent = savedEmail;
            document.getElementById("profilEmail").textContent = savedEmail;
            document.getElementById("loginModal").style.display = "none";
            openTab('logisztikai-adatbazis');
        } else {
            hideAllTabs();
        }

        function checkLogin() {
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const resultDiv = document.getElementById("result");

            localStorage.setItem("email", email);

            if (password === "3211") {
                resultDiv.textContent = "kész";
                resultDiv.style.color = "#4CAF50";
                document.getElementById("loginModal").style.display = "none";
                document.getElementById("userEmail").textContent = email;
                document.getElementById("profilEmail").textContent = email;
                openTab('logisztikai-adatbazis');
                initializeFilters('logisztikai-table');
            } else {
                resultDiv.textContent = "Helytelen jelszó!";
                resultDiv.style.color = "#F44336";
            }
        }

        function logout() {
            localStorage.removeItem("email");
            hideAllTabs();
            location.reload();
        }

        function toggleFullscreen() {
            const fullscreenIcon = document.querySelector(".fullscreen-icon");
            const container = document.getElementById("container");

            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                fullscreenIcon.classList.remove("fa-expand");
                fullscreenIcon.classList.add("fa-compress");
                fullscreenIcon.title = "Kilépés a teljes képernyőből";
                container.style.height = "100vh";
            } else {
                document.exitFullscreen();
                fullscreenIcon.classList.remove("fa-compress");
                fullscreenIcon.classList.add("fa-expand");
                fullscreenIcon.title = "Teljes képernyő";
                const windowHeight = window.innerHeight;
                container.style.height = `${windowHeight}px`;
            }
        }

        function openTab(tabName) {
            if (!localStorage.getItem("email")) return;

            const tabs = document.getElementsByClassName("tab");
            const tabContents = document.getElementsByClassName("tab-content");

            for (let i = 0; i < tabs.length; i++) tabs[i].classList.remove("active");
            for (let i = 0; i < tabContents.length; i++) tabContents[i].classList.remove("active");

            document.getElementById(tabName).classList.add("active");
            const tabElement = document.querySelector(`.tab[onclick="openTab('${tabName}')"]`);
            if (tabElement) tabElement.classList.add("active");

            if (tabName !== 'profil') document.getElementById("profil").style.display = "none";
        }

        function toggleProfile() {
            if (!localStorage.getItem("email")) return;

            const profilTab = document.getElementById("profil");
            if (profilTab.style.display === "block") {
                profilTab.style.display = "none";
                openTab('logisztikai-adatbazis');
            } else {
                openTab('profil');
                profilTab.style.display = "block";
            }
        }

        function initializeFilters(tableId) {
            const table = document.getElementById(tableId);
            const headers = table.getElementsByTagName("th");
            const rows = table.getElementsByTagName("tbody")[0].getElementsByTagName("tr");

            for (let col = 0; col < headers.length; col++) {
                if (headers[col].textContent === "Műveletek") continue;

                const values = new Set();
                for (let i = 0; i < rows.length; i++) {
                    const cell = rows[i].getElementsByTagName("td")[col];
                    if (cell) values.add(cell.textContent);
                }

                const select = headers[col].querySelector("select");
                select.innerHTML = '<option value="Összes">Összes</option>';
                values.forEach(value => {
                    const option = document.createElement("option");
                    option.value = value;
                    option.textContent = value;
                    select.appendChild(option);
                });
            }
        }

        function toggleFilterDropdown(arrow, columnIndex, tableId) {
            const dropdown = arrow.nextElementSibling;
            dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
        }

        function filterTable(select, columnIndex, tableId) {
            const filterValue = select.value;
            const table = document.getElementById(tableId);
            const rows = table.getElementsByTagName("tbody")[0].getElementsByTagName("tr");

            for (let i = 0; i < rows.length; i++) {
                const cell = rows[i].getElementsByTagName("td")[columnIndex];
                if (cell) {
                    const cellText = cell.textContent;
                    rows[i].style.display = (filterValue === "Összes" || cellText === filterValue) ? "" : "none";
                }
            }
        }
    </script>
</body>
</html>
